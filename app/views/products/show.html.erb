<div class="product-show-container">

  <div class="product-show-container__main">
    <div class="product-show-container__img-grid">
      <% if @product.image1.attached? %>
        <%= image_tag @product.image1, class:"product-show-container__img"%>
      <% else %>
        <%= image_tag "no-product-image.png", class:"product-show-container__img no-image" %>
      <% end %>
    </div>

    <div class="products-show-container__color-carrousel">
      <% same_product_different_colors(@product, @products).map do |p|%>
        <div id="products-show-container__color-carrousel-options">
          <% if p.image1.attached? %>
            <%= link_to(p) do %>
              <%= image_tag p.image1, class: "products-show-container__color-img", alt: "#{@product.name} in #{@product.color}"%>
            <% end %>  
          <% else %>
            <%= link_to(p) do %>
              <%= image_tag "no-product-image.png", class: "products-show-container__color-img", alt: "product has no image"%>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>

    <h2>You might also like</h2>
    <div class="products-show-container__you-might-also-like">
      <%= render "home/new-arrivals" %>
    </div>
  </div>  


  <div class="product-show-container__side">
    <h1><%= @product.name %></h1>
    <% if @product_categories %>
      <ul class="product-show-container__categories">
        <li><%= @product.gender.name %></li>
        <span> / </span>
        <% @product_categories.each do |category|  %>
          <li><%= category.name %></li>
          <span> / </span>
        <% end %>
      </ul>
    <% end %>
      <p>
        <strong>Select size</strong>
        <%# show option of sizes%>
        <ul class="sizes-available">
          <% sizes_available = sizes_available(@product).map(&:size).map(&:number) %>
            <% @sizes.each do |size| %>
              <% if sizes_available.include?(size.number) %>
                <li class="size-available"><%= size.number %></li>
              <% else %>
                <li><%= size.number %></li>
              <% end %>
            <% end %>
        </ul>
      </p>
      
      
    
    
      <%= form_with model: OrderItem, url: user_order_order_items_path(@order, current_user) do |form| %>
        <%= form.hidden_field :name, value: @product.name %>
        <%= form.hidden_field :color, value: @product.color %>
        <%= form.hidden_field :size %>

            
        <div>
          <%= form.label :quantity, style: "display: block" %>
          <%= form.number_field :quantity %>
        </div>

        <div>
          <% if current_user %>
            <%= form.submit "Add to cart", id:"add-to-cart-btn-unlogged", class:"products-show-container__add-to-cart-btn" %>
          <% else %>
            <button type="button" class="products-show-container__add-to-cart-btn">"Add to cart"</button>
          <% end %>
        </div>
      <% end %>
  </div>  
</div>


<%= link_to "Back to products", products_path %>